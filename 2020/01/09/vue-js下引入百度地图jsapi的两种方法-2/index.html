<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>vue.js下引入百度地图jsApi的两种方法 | luoqua的博客</title>
    <meta name="description" content="This is a blog example built by VuePress">
    
    
    <link rel="preload" href="/luoqua-blog/assets/css/0.styles.e89b177c.css" as="style"><link rel="preload" href="/luoqua-blog/assets/js/app.5a0e335a.js" as="script"><link rel="preload" href="/luoqua-blog/assets/js/4.f8956c2b.js" as="script"><link rel="preload" href="/luoqua-blog/assets/js/5.c8b9e4c7.js" as="script"><link rel="preload" href="/luoqua-blog/assets/js/17.ebd41bb3.js" as="script"><link rel="prefetch" href="/luoqua-blog/assets/js/1.d284dc83.js"><link rel="prefetch" href="/luoqua-blog/assets/js/10.8a9299e4.js"><link rel="prefetch" href="/luoqua-blog/assets/js/11.10164942.js"><link rel="prefetch" href="/luoqua-blog/assets/js/12.e77bc74c.js"><link rel="prefetch" href="/luoqua-blog/assets/js/13.3aeb8d34.js"><link rel="prefetch" href="/luoqua-blog/assets/js/14.32f2261a.js"><link rel="prefetch" href="/luoqua-blog/assets/js/15.0bc4651d.js"><link rel="prefetch" href="/luoqua-blog/assets/js/16.387bc3fd.js"><link rel="prefetch" href="/luoqua-blog/assets/js/18.48b93ba2.js"><link rel="prefetch" href="/luoqua-blog/assets/js/6.5a5be062.js"><link rel="prefetch" href="/luoqua-blog/assets/js/7.e81f8fc3.js"><link rel="prefetch" href="/luoqua-blog/assets/js/8.66de6e94.js"><link rel="prefetch" href="/luoqua-blog/assets/js/9.16a4a651.js"><link rel="prefetch" href="/luoqua-blog/assets/js/vuejs-paginate.63d3a700.js">
    <link rel="stylesheet" href="/luoqua-blog/assets/css/0.styles.e89b177c.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div id="vuepress-theme-blog__global-layout"><section id="header-wrapper"><header id="header"><div class="header-wrapper"><div class="title"><a href="/luoqua-blog/" class="nav-link home-link">luoqua的博客 </a></div> <div class="header-right-wrap"><ul class="nav"><li class="nav-item"><a href="/luoqua-blog/" class="nav-link">博客</a></li><li class="nav-item"><a href="/luoqua-blog/tag/" class="nav-link">标签</a></li></ul> <div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div></div></div></header></section> <div id="mobile-header"><div class="mobile-header-bar"><div class="mobile-header-title"><a href="/luoqua-blog/" class="nav-link mobile-home-link">luoqua的博客 </a> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"><line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line></svg></div> <div class="mobile-menu-wrapper"><hr class="menu-divider"> <ul class="mobile-nav"><li class="mobile-nav-item"><a href="/luoqua-blog/" class="nav-link">博客</a></li><li class="mobile-nav-item"><a href="/luoqua-blog/tag/" class="nav-link">标签</a></li></ul></div></div></div> <div class="content-wrapper"><div id="vuepress-theme-blog__post-layout"><div class="vuepress-blog-theme-content"><div class="content__default"><h1 id="vue-js下引入百度地图jsapi的两种方法"><a href="#vue-js下引入百度地图jsapi的两种方法" class="header-anchor">#</a> vue.js下引入百度地图jsApi的两种方法</h1> <p><img src="http://ztmao.com/demo/helen/wp-content/uploads/2017/07/disnep-3.gif" alt="avatar"></p> <h2 id="前言"><a href="#前言" class="header-anchor">#</a> 前言</h2> <p>今天有个项目需要用到百度地图，一般我们在移动端使用百度地图，都是直接通过这样的方式，直接引入百度地图的jsApi。</p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>text/javascript<span class="token punctuation">&quot;</span></span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>http://api.map.baidu.com/api?v=2.0&amp;ak=<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>这种方法的原理，就是直接给全局widow对象添加一个BMap对象，从而可以使我们在已经加载api的页面的任何地方，使用百度地图的api。但是单单通过引入的方法，对于使用单文件组件的vue+webpack开发的项目，显然是不够的。于是，通过网上查资料。这里找到了两种方法。</p> <h2 id="直接引入script标签"><a href="#直接引入script标签" class="header-anchor">#</a> 直接引入script标签</h2> <p>第一种方法是通过直接引入的方法，当然除了引入script标签还不够，要想在vue文件中使用bmap对象，还需要在webpack的配置文件中，设置外部扩展(externals属性)</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">//webpack.dev.conf.js</span>

externals<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token string">'BaiduMap'</span><span class="token operator">:</span> <span class="token string">'BMap'</span>
<span class="token punctuation">}</span>
</code></pre></div><p>externales属性来自官方的解释是:</p> <p>::: tip
防止将某些 import 的包(package)打包到 bundle 中，而是在运行时(runtime)再去从外部获取这些扩展依赖(external dependencies)。
:::</p> <p>webpack文档也给出了一个示例：从 CDN 引入 jQuery，而不是把它打包。</p> <div class="language-html extra-class"><pre class="language-html"><code>// index.html
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span>
  <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>https://code.jquery.com/jquery-3.1.0.js<span class="token punctuation">&quot;</span></span>
  <span class="token attr-name">integrity</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>sha256-slogkvB1K3VOkzAI8QITxV3VzpOnkeNVsKvtkYLMjfk=<span class="token punctuation">&quot;</span></span>
  <span class="token attr-name">crossorigin</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>anonymous<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">//webpack.config.js</span>

externals<span class="token operator">:</span> <span class="token punctuation">{</span>
  jquery<span class="token operator">:</span> <span class="token string">'jQuery'</span>
<span class="token punctuation">}</span>

<span class="token comment">//app.js</span>

<span class="token keyword">import</span> $ <span class="token keyword">from</span> <span class="token string">'jquery'</span><span class="token punctuation">;</span>

<span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'.my-element'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">animate</span><span class="token punctuation">(</span><span class="token operator">...</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre></div><p>参考这个实例，我们就可以在我们的项目中通过引入js文件的方法，直接使用百度地图的api。</p> <div class="language-js extra-class"><pre class="language-js"><code>
<span class="token keyword">import</span> BaiduMap <span class="token keyword">from</span> <span class="token string">'BaiduMap'</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
    name<span class="token operator">:</span> <span class="token string">'Index'</span><span class="token punctuation">,</span>
    <span class="token operator">...</span><span class="token punctuation">.</span><span class="token punctuation">.</span>

    <span class="token function">mounted</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        
      <span class="token keyword">var</span> map <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BaiduMap<span class="token punctuation">.</span>Map</span><span class="token punctuation">(</span><span class="token string">'allmap'</span><span class="token punctuation">)</span>                        <span class="token comment">// 创建地图实例</span>
      <span class="token keyword">var</span> point <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BaiduMap<span class="token punctuation">.</span>Point</span><span class="token punctuation">(</span><span class="token number">120.343373</span><span class="token punctuation">,</span><span class="token number">31.540212</span><span class="token punctuation">)</span>        <span class="token comment">// 创建中心点坐标</span>
      <span class="token keyword">var</span> marker <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BaiduMap<span class="token punctuation">.</span>Marker</span><span class="token punctuation">(</span>point<span class="token punctuation">)</span> <span class="token comment">// 创建标注</span>

      map<span class="token punctuation">.</span><span class="token function">centerAndZoom</span><span class="token punctuation">(</span>point<span class="token punctuation">,</span><span class="token number">15</span><span class="token punctuation">)</span>                         <span class="token comment">// 初始化地图，设置中心点坐标和地图级别</span>


      map<span class="token punctuation">.</span><span class="token function">addOverlay</span><span class="token punctuation">(</span>marker<span class="token punctuation">)</span> <span class="token comment">// 将标注添加到地图中</span>

  <span class="token punctuation">}</span>

</code></pre></div><p>注意这里，实例化地图api，最好要在mounted阶段进行，如果你的dom中采用的是官方的示例如</p> <div class="language-html extra-class"><pre class="language-html"><code>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>allmap<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>因为只有在mounted的阶段，dom才会生成并挂载。</p> <h2 id="通过模块化引入的方法"><a href="#通过模块化引入的方法" class="header-anchor">#</a> 通过模块化引入的方法</h2> <p>实际上百度地图官方去年已经开源了基于jsApi的vue和react的对应开源组件，我们可以直接通过npm安装，然后使用。</p> <ul><li><a href="https://github.com/Dafrok/vue-baidu-map" target="_blank" rel="noopener noreferrer">VUE<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://github.com/huiyan-fe/react-bmap" target="_blank" rel="noopener noreferrer">React<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul> <p>可参考它们在github上面的文档进行使用。这里只介绍下vue的。</p> <ul><li>安装</li></ul> <div class="language-js extra-class"><pre class="language-js"><code>  npm i vue<span class="token operator">-</span>baidu<span class="token operator">-</span>map <span class="token operator">--</span>save
</code></pre></div><ul><li>初始化</li></ul> <div class="language-js extra-class"><pre class="language-js"><code>  <span class="token keyword">import</span> Vue <span class="token keyword">from</span> <span class="token string">'vue'</span>
  <span class="token keyword">import</span> BaiduMap <span class="token keyword">from</span> <span class="token string">'vue-baidu-map'</span>

  Vue<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>BaiduMap<span class="token punctuation">,</span> <span class="token punctuation">{</span>
    ak<span class="token operator">:</span> <span class="token string">'YOUR_APP_KEY'</span>    <span class="token comment">//这个地方是官方提供的ak密钥</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><ul><li>使用</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token operator">&lt;</span>template<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>baidu<span class="token operator">-</span>map <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;map&quot;</span><span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span><span class="token operator">/</span>baidu<span class="token operator">-</span>map<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>style<span class="token operator">&gt;</span>
<span class="token comment">/* The container of BaiduMap must be set width &amp; height. */</span>
<span class="token punctuation">.</span>map <span class="token punctuation">{</span>
  width<span class="token operator">:</span> <span class="token number">100</span><span class="token operator">%</span><span class="token punctuation">;</span>
  height<span class="token operator">:</span> <span class="token number">300</span>px<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>style<span class="token operator">&gt;</span>
</code></pre></div></div> <!----> <hr> <!----></div> <div class="sticker vuepress-toc"><div class="vuepress-toc-item vuepress-toc-h2 active"><a href="#前言" title="前言">前言</a></div><div class="vuepress-toc-item vuepress-toc-h2"><a href="#直接引入script标签" title="直接引入script标签">直接引入script标签</a></div><div class="vuepress-toc-item vuepress-toc-h2"><a href="#通过模块化引入的方法" title="通过模块化引入的方法">通过模块化引入的方法</a></div></div></div></div> <footer class="footer" data-v-713d1cb8><div class="footer-left-wrap" data-v-713d1cb8><ul class="contact" data-v-713d1cb8><li class="contact-item" data-v-713d1cb8><a href="https://github.com/luoqua/luoqua-blog" target="_blank" rel="noopener noreferrer" class="nav-link external" data-v-713d1cb8><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-github" data-v-713d1cb8><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22" data-v-713d1cb8></path></svg>
          
        </a></li></ul></div> <div class="footer-right-wrap" data-v-713d1cb8><ul class="copyright" data-v-713d1cb8><li class="copyright-item" data-v-713d1cb8><a href="https://policies.google.com/privacy?hl=en-US" target="_blank" rel="noopener noreferrer" class="nav-link external" data-v-713d1cb8>Privacy Policy</a></li><li class="copyright-item" data-v-713d1cb8><a href="/luoqua-blog/2020/01/09/vue-js%E4%B8%8B%E5%BC%95%E5%85%A5%E7%99%BE%E5%BA%A6%E5%9C%B0%E5%9B%BEjsapi%E7%9A%84%E4%B8%A4%E7%A7%8D%E6%96%B9%E6%B3%95-2/.html" class="nav-link" data-v-713d1cb8>MIT Licensed | Copyright © 2018-present Vue.js</a></li></ul></div></footer></div><div class="global-ui"></div></div>
    <script src="/luoqua-blog/assets/js/app.5a0e335a.js" defer></script><script src="/luoqua-blog/assets/js/4.f8956c2b.js" defer></script><script src="/luoqua-blog/assets/js/5.c8b9e4c7.js" defer></script><script src="/luoqua-blog/assets/js/17.ebd41bb3.js" defer></script>
  </body>
</html>
